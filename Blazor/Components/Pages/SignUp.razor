@page "/SignUp"
@using API.Models
@inject HttpClient Http
@inject Service.DatabaseServices DatabaseServices
@inject NavigationManager NavigationManager

<PageTitle>SignUp</PageTitle>

<!-- Main container for the signup form -->
<div class="container d-flex align-items-center justify-content-center custom-margin-top">
    <div class="row justify-content-center w-100">
        <div class="col-md-8 col-lg-6">
            <div class="card shadow-lg p-4 rounded-lg">
                <!-- Header section with title and description -->
                <div class="card-header text-center">
                    <h3 class="text-uppercase">Opret konto</h3>
                    <p class="text-muted">Udfyld formularen for at oprette en ny konto</p>
                </div>
                <div class="card-body">
                    <!-- Signup form -->
                    <form>
                        <div class="row">
                            <!-- Input fields for user details -->
                            <div class="col-12 col-md-6 mb-3">
                                <input type="text" class="form-control" id="FirstName" placeholder="Fornavn" @bind="newUser.FirstName" required>
                            </div>
                            <div class="col-12 col-md-6 mb-3">
                                <input type="text" class="form-control" id="LastName" placeholder="Efternavn" @bind="newUser.LastName" required>
                            </div>
                            <div class="col-12 mb-3">
                                <input type="email" class="form-control" id="Email" placeholder="Email" @bind="newUser.Email" required>
                            </div>
                            <div class="col-12 mb-3">
                                <input type="password" class="form-control" id="Password" placeholder="Adgangskode" @bind="newUser.Password" required>
                            </div>
                            <div class="col-12 mb-3">
                                <input type="password" class="form-control" id="PasswordRepeat" placeholder="Bekræft adgangskode" @bind="newUser.PasswordRepeat" required>
                            </div>
                            <div class="col-12 mb-3">
                                <input type="tel" class="form-control" id="PhoneNumber" placeholder="Telefonnummer" @bind="newUser.PhoneNumber" required>
                            </div>
                            <div class="col-12 mb-3">
                                <input type="text" class="form-control" id="Address" placeholder="Adresse" @bind="newUser.Address" required>
                            </div>
                            <div class="col-12 mb-3">
                                <input type="text" class="form-control" id="City" placeholder="By" @bind="newUser.City" required>
                            </div>
                            <div class="col-12 mb-3">
                                <input type="text" class="form-control" id="Country" placeholder="Land" @bind="newUser.Country" required>
                            </div>
                            <div class="col-12 mb-3">
                                <input type="text" class="form-control" id="Zip" placeholder="Postnummer" @bind="newUser.Zip" required>
                            </div>
                            <!-- Checkbox for terms and conditions -->
                            <div class="col-12 mb-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="" id="AgreeCheckbox" required />
                                    <label class="form-check-label" for="AgreeCheckbox">
                                        Jeg accepterer <a href="#!" class="text-body"><u>vilkårene</u></a>
                                    </label>
                                </div>
                            </div>
                            <!-- Submit button to register the user -->
                            <div class="col-12 text-center">
                                <button type="button" class="btn btn-primary" @onclick="RegisterUser">Registrer</button>
                            </div>
                        </div>
                        <!-- Link to the login page for existing users -->
                        <p class="text-center text-muted mt-4 mb-0">Har du allerede en konto? <a href="/login" class="fw-bold text-body"><u>Log ind her</u></a></p>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    // DTO for binding form input values
    private UserPostAndPutDTO newUser = new UserPostAndPutDTO();

    // Method to handle user registration
    private async Task RegisterUser()
    {
        // Check if the passwords match
        if (newUser.Password != newUser.PasswordRepeat)
        {
            // Handle password mismatch (e.g., show a validation message)
            return;
        }
        // Set the role for the new user
        newUser.Role = "Guest";
        // Call the service to add the user to the database
        await DatabaseServices.AddUserToDatabaseAsync(newUser);
        // Redirect to the login page after successful registration
        NavigationManager.NavigateTo("/login");
    }
}

<style>
    /* Custom margin for the form container */
    .custom-margin-top {
        margin-top: 50px;
    }

    /* Styling for the primary button */
    .btn-primary {
        padding: 12px 20px;
        border-radius: 6px;
        font-weight: bold;
        background-color: #cba135;
        color: white;
        border: none;
        cursor: pointer;
        transition: background-color 0.3s, box-shadow 0.3s;
    }

        .btn-primary:hover {
            background-color: #b38b30;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }

    /* Styling for form controls */
    .form-control {
        border-radius: 6px;
        border: 1px solid #ccc;
        padding: 10px;
    }

    /* Checkbox input styling */
    .form-check-input {
        margin-right: 10px;
    }

    .form-check-label {
        font-weight: normal;
    }

    /* Card styling */
    .card {
        background-color: #ffffff;
        border: none;
    }
</style>
